<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Price Counter</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <style>
    body { 
      margin: 0; 
      padding: 0; 
      overflow: hidden; 
      height: 100vh;
    }
    canvas { 
      display: block; 
      height: 100vh;
      width: 100vw;
    }
  </style>
</head>
<body>
  <script>
    let products = [
      { name: "Filet", price: 8.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet a la minute", price: 9.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet strips", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet blokjes", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Haasjes", price: 8.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Haasjes blokjes", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Dijen", price: 7.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Dijen blokjes", price: 9, count: 0, plusBtn: null, minusBtn: null },
      { name: "Drumsticks", price: 4.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Karbonades", price: 6, count: 0, plusBtn: null, minusBtn: null },
      { name: "Kipribs", price: 7, count: 0, plusBtn: null, minusBtn: null },
      { name: "Bouten", price: 4.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Poten", price: 4.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Shoarma", price: 8.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Bezorgkosten", price: 2.5, count: 0, plusBtn: null, minusBtn: null }
    ];
    let total = 0;
    let heldProductIndex = -1;
    let holdStartTime = 0;
    let holdInterval = 100;
    let itemSpacing;
    let startY;
    let textScale;

    function formatPrice(num) {
      let str = num.toFixed(2).replace('.', ',');
      if (str.endsWith(',00')) {
        return str.slice(0, -3);
      } else if (str.endsWith(',50')) {
        return str.slice(0, -2) + '5';
      }
      return str;
    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      textAlign(LEFT);
      fill(0);

      // Dynamic sizing
      let headerHeight = 50;
      let totalHeight = 45;
      let availableHeight = height - headerHeight - totalHeight - 10; // Extra padding to avoid overlap
      itemSpacing = availableHeight / products.length;
      startY = headerHeight + totalHeight + 5; // Slight offset to prevent overlap
      textScale = min(12, itemSpacing * 0.35); // Scale text based on spacing

      // Header
      fill(50, 150, 200);
      rect(0, 0, width, headerHeight, 0, 0, 20, 20);
      fill(255);
      textStyle(BOLD);
      text("Price Counter", 10, headerHeight * 0.7);

      // Product buttons (dynamic positioning)
      for (let i = 0; i < products.length; i++) {
        let y = startY + i * itemSpacing;
        let btnSize = min(30, itemSpacing * 0.8);
        let btnOffset = (itemSpacing - btnSize) / 2;

        products[i].plusBtn = createButton('+');
        products[i].plusBtn.position(width - 50, y - btnOffset);
        products[i].plusBtn.size(btnSize, btnSize);
        products[i].plusBtn.style('background-color', '#4CAF50');
        products[i].plusBtn.style('border', 'none');
        products[i].plusBtn.style('border-radius', btnSize / 2 + 'px');
        products[i].plusBtn.style('color', 'white');
        products[i].plusBtn.style('font-size', max(12, btnSize * 0.5) + 'px');
        products[i].plusBtn.touchStarted(() => {
          products[i].count += 1;
          heldProductIndex = i;
          holdStartTime = millis();
        });
        products[i].plusBtn.touchEnded(() => {
          heldProductIndex = -1;
        });

        products[i].minusBtn = createButton('-');
        products[i].minusBtn.position(width - 85, y - btnOffset);
        products[i].minusBtn.size(btnSize, btnSize);
        products[i].minusBtn.style('background-color', '#F44336');
        products[i].minusBtn.style('border', 'none');
        products[i].minusBtn.style('border-radius', btnSize / 2 + 'px');
        products[i].minusBtn.style('color', 'white');
        products[i].minusBtn.style('font-size', max(12, btnSize * 0.5) + 'px');
        products[i].minusBtn.touchStarted(() => {
          products[i].count = max(0, products[i].count - 1);
        });
      }
    }

    function draw() {
      background(240, 245, 250);
      total = 0;

      // Calculate total first
      for (let i = 0; i < products.length; i++) {
        let p = products[i];
        total += p.price * p.count;
      }

      // Total at top
      let headerHeight = 50;
      let totalHeight = 45;
      let totalY = headerHeight;
      fill(0, 180, 0);
      noStroke();
      rect(0, totalY, width, totalHeight, 10, 10, 0, 0);
      fill(255);
      textStyle(BOLD);
      text("Total: â‚¬" + formatPrice(total), 10, totalY + totalHeight * 0.7);

      // Products
      textStyle(NORMAL);
      for (let i = 0; i < products.length; i++) {
        let p = products[i];
        let subtotal = p.price * p.count;
        let y = startY + i * itemSpacing;
        fill(255);
        stroke(200);
        rect(5, y - itemSpacing / 2, width - 10, itemSpacing, 8);
        noStroke();
        fill(50);
        textStyle(BOLD);
        text(p.name, 10, y);
        textStyle(NORMAL);
        text(p.count + " = " + formatPrice(subtotal), 150, y);
      }

      if (heldProductIndex !== -1) {
        let elapsed = millis() - holdStartTime;
        if (elapsed > 200) {
          let speed = max(20, holdInterval - floor(elapsed / 500) * 30);
          if (frameCount % floor(speed / 16) === 0) {
            products[heldProductIndex].count += 1;
          }
        }
      }
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
      // Re-setup dynamic values on resize
      let headerHeight = 50;
      let totalHeight = 45;
      let availableHeight = height - headerHeight - totalHeight - 10;
      itemSpacing = availableHeight / products.length;
      startY = headerHeight + totalHeight + 5;
      textScale = min(12, itemSpacing * 0.35);
    }
  </script>
</body>
</html>
