<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Price Counter</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <style>
    body { margin: 0; padding: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
  <script>
    let products = [
      { name: "Filet", price: 8.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet a la minute", price: 9.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet strips", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Filet blokjes", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Haasjes", price: 8.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Haasjes blokjes", price: 10, count: 0, plusBtn: null, minusBtn: null },
      { name: "Dijen", price: 7.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Dijen blokjes", price: 9, count: 0, plusBtn: null, minusBtn: null },
      { name: "Drumsticks", price: 4.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Karbonades", price: 6, count: 0, plusBtn: null, minusBtn: null },
      { name: "Kipribs", price: 7, count: 0, plusBtn: null, minusBtn: null },
      { name: "Bouten", price: 4.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Poten", price: 4.75, count: 0, plusBtn: null, minusBtn: null },
      { name: "Shoarma", price: 8.5, count: 0, plusBtn: null, minusBtn: null },
      { name: "Bezorgkosten", price: 2.5, count: 0, plusBtn: null, minusBtn: null }
    ];
    let total = 0;
    let heldProductIndex = -1;
    let holdStartTime = 0;
    let holdInterval = 100;

    function formatPrice(num) {
      let str = num.toFixed(2).replace('.', ',');
      if (str.endsWith(',00')) {
        return str.slice(0, -3);
      } else if (str.endsWith(',50')) {
        return str.slice(0, -2) + '5';
      }
      return str;
    }

    function setup() {
      createCanvas(windowWidth, windowHeight);
      textSize(11);
      textAlign(LEFT);
      fill(0);

      // Header
      fill(50, 150, 200);
      rect(0, 0, width, 45, 0, 0, 15, 15);
      fill(255);
      textSize(16);
      textStyle(BOLD);
      text("Price Counter", 10, 30);

      // Product buttons (tighter spacing)
      for (let i = 0; i < products.length; i++) {
        let y = 95 + i * 32;
        products[i].plusBtn = createButton('+');
        products[i].plusBtn.position(width - 45, y - 12);
        products[i].plusBtn.size(28, 28);
        products[i].plusBtn.style('background-color', '#4CAF50');
        products[i].plusBtn.style('border', 'none');
        products[i].plusBtn.style('border-radius', '14px');
        products[i].plusBtn.style('color', 'white');
        products[i].plusBtn.style('font-size', '13px');
        products[i].plusBtn.touchStarted(() => {
          products[i].count += 1;
          heldProductIndex = i;
          holdStartTime = millis();
        });
        products[i].plusBtn.touchEnded(() => {
          heldProductIndex = -1;
        });

        products[i].minusBtn = createButton('-');
        products[i].minusBtn.position(width - 78, y - 12);
        products[i].minusBtn.size(28, 28);
        products[i].minusBtn.style('background-color', '#F44336');
        products[i].minusBtn.style('border', 'none');
        products[i].minusBtn.style('border-radius', '14px');
        products[i].minusBtn.style('color', 'white');
        products[i].minusBtn.style('font-size', '13px');
        products[i].minusBtn.touchStarted(() => {
          products[i].count = max(0, products[i].count - 1);
        });
      }
    }

    function draw() {
      background(240, 245, 250);
      total = 0;

      // Calculate total first
      for (let i = 0; i < products.length; i++) {
        let p = products[i];
        total += p.price * p.count;
      }

      // Total at top (adjusted position)
      let totalY = 45;
      fill(0, 180, 0);
      noStroke();
      rect(0, totalY, width, 40, 8, 8, 0, 0);
      fill(255);
      textSize(13);
      textStyle(BOLD);
      text("Total: â‚¬" + formatPrice(total), 10, totalY + 27);

      // Reset for products
      textSize(11);
      textStyle(NORMAL);

      for (let i = 0; i < products.length; i++) {
        let p = products[i];
        let subtotal = p.price * p.count;
        let y = 95 + i * 32;
        fill(255);
        stroke(200);
        rect(5, y - 16, width - 10, 32, 6);
        noStroke();
        fill(50);
        textStyle(BOLD);
        text(p.name, 10, y + 5);
        textStyle(NORMAL);
        text(p.count + " = " + formatPrice(subtotal), 140, y + 5);
      }

      if (heldProductIndex !== -1) {
        let elapsed = millis() - holdStartTime;
        if (elapsed > 200) {
          let speed = max(20, holdInterval - floor(elapsed / 500) * 30);
          if (frameCount % floor(speed / 16) === 0) {
            products[heldProductIndex].count += 1;
          }
        }
      }
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
    }
  </script>
</body>
</html>
